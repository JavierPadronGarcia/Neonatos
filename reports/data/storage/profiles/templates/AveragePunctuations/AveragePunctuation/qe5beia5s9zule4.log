{"type":"operationStart","subtype":"profile","data":{"_id":"ihvWkp7u5qQqUn1m","timestamp":"2024-01-13T13:46:55.360Z","state":"queued","mode":"standard","creationDate":"2024-01-13T13:46:55.363Z","modificationDate":"2024-01-13T13:46:55.363Z","shortid":"JAawyNc","$entitySet":"profiles"},"doDiffs":false,"timestamp":1705153615361,"id":"23l8x26u20kz78c","previousOperationId":null,"operationId":"jv31dd7zo5ik5q2"}
{"type":"log","level":"info","message":"Render request 1 queued for execution and waiting for available worker","previousOperationId":"jv31dd7zo5ik5q2","timestamp":1705153615361,"id":"9fq6x795qf17kjj"}
{"type":"operationStart","subtype":"render","name":"AveragePunctuation","previousOperationId":"jv31dd7zo5ik5q2","timestamp":1705153615378,"id":"viqgsdd49f4p6hg","previousEventId":"23l8x26u20kz78c","operationId":"oxdv38811zpp9xp"}
{"type":"log","timestamp":1705153615380,"level":"info","message":"Starting rendering request 1","meta":{"rootId":"qe5beia5s9zule4","id":"qe5beia5s9zule4"},"id":"5eglesxb2ahkb13","previousOperationId":"oxdv38811zpp9xp"}
{"type":"log","timestamp":1705153615382,"level":"info","message":"Rendering template { name: AveragePunctuation, recipe: chrome-pdf, engine: handlebars, preview: false }","meta":{"rootId":"qe5beia5s9zule4","id":"qe5beia5s9zule4"},"id":"zpb2mkvmz7lxic4","previousOperationId":"oxdv38811zpp9xp"}
{"type":"log","timestamp":1705153615383,"level":"debug","message":"Inline data specified.","meta":{"rootId":"qe5beia5s9zule4","id":"qe5beia5s9zule4"},"id":"wyxjm3d0qf9vjz2","previousOperationId":"oxdv38811zpp9xp"}
{"type":"log","timestamp":1705153615386,"level":"debug","message":"Executing script AveragePunctuation-script (beforeRender)","meta":{"rootId":"qe5beia5s9zule4","id":"qe5beia5s9zule4"},"id":"j90mxdc7j72u2bz","previousOperationId":"oxdv38811zpp9xp"}
{"type":"operationStart","subtype":"scriptsBeforeRender","name":"scripts beforeRender","timestamp":1705153615844,"id":"oxw4pr1flnum9e2","previousEventId":"viqgsdd49f4p6hg","operationId":"ery87b1q8ivckfs","previousOperationId":"oxdv38811zpp9xp"}
{"type":"operationStart","subtype":"script","name":"scripts AveragePunctuation-script","previousOperationId":"ery87b1q8ivckfs","timestamp":1705153615844,"id":"9gvnrf13ti05f1f","previousEventId":"oxw4pr1flnum9e2","operationId":"gfnkzihmdaffgmx"}
{"type":"log","timestamp":1705153615849,"level":"warn","message":"Error when processing render request 1\n(because) error when evaluating custom script /templates/AveragePunctuations/AveragePunctuation-script\nreq is not defined\n\n(sandbox.js line 17:69)\n\n  15 | async function fetchUserActivities(token, params) {\n  16 |     return new Promise((resolve, reject) => {\n> 17 |         const {groupId, workUnitId, caseId, assigned, finishDate} = req.params;\n     |                                                                     ^\n  18 |\n  19 |         axios.get(`http://localhost:12080/api/exercises/studentsAssignedToExerciseWithDetails/${groupId}/${workUnitId}/${caseId}/${assigned}/${finishDate}`,\n  20 |             getOptions(token)).then(response => {\n\n(sandbox.js line 16:12)\n\n  14 |\n  15 | async function fetchUserActivities(token, params) {\n> 16 |     return new Promise((resolve, reject) => {\n     |            ^\n  17 |         const {groupId, workUnitId, caseId, assigned, finishDate} = req.params;\n  18 |\n  19 |         axios.get(`http://localhost:12080/api/exercises/studentsAssignedToExerciseWithDetails/${groupId}/${workUnitId}/${caseId}/${assigned}/${finishDate}`,\n\n(sandbox.js line 31:37)\n\n  29 |     const token = req.data.token;\n  30 |     req.data.user = jwt.decode(token);\n> 31 |     req.data.userActivities = await fetchUserActivities(token, req.data.params);\n     |                                     ^\n  32 | }\n\n(sandbox.js line 44:18)\nReferenceError: req is not defined\n    at sandbox.js:17:69\n    at new Promise (<anonymous>)\n    at fetchUserActivities (sandbox.js:16:12)\n    at Object.beforeRender (sandbox.js:31:37)\n    at executionFn (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:35)\n    at sandbox.js:44:18\n    at async run (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:137:16)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:14)\n    at async executeScript (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)","meta":{"rootId":"qe5beia5s9zule4","id":"qe5beia5s9zule4"},"id":"lhpwgkedia6k19s","previousOperationId":"gfnkzihmdaffgmx"}
{"type":"log","timestamp":1705153615849,"level":"warn","message":"Rendering request 1 finished with error in 490 ms","meta":{"rootId":"qe5beia5s9zule4","id":"qe5beia5s9zule4"},"id":"j2emayonsstlell","previousOperationId":"gfnkzihmdaffgmx"}
{"type":"error","timestamp":1705153615852,"statusCode":400,"weak":true,"lineNumber":17,"decoratedSuffix":"\n\n(sandbox.js line 17:69)\n\n  15 | async function fetchUserActivities(token, params) {\n  16 |     return new Promise((resolve, reject) => {\n> 17 |         const {groupId, workUnitId, caseId, assigned, finishDate} = req.params;\n     |                                                                     ^\n  18 |\n  19 |         axios.get(`http://localhost:12080/api/exercises/studentsAssignedToExerciseWithDetails/${groupId}/${workUnitId}/${caseId}/${assigned}/${finishDate}`,\n  20 |             getOptions(token)).then(response => {\n\n(sandbox.js line 16:12)\n\n  14 |\n  15 | async function fetchUserActivities(token, params) {\n> 16 |     return new Promise((resolve, reject) => {\n     |            ^\n  17 |         const {groupId, workUnitId, caseId, assigned, finishDate} = req.params;\n  18 |\n  19 |         axios.get(`http://localhost:12080/api/exercises/studentsAssignedToExerciseWithDetails/${groupId}/${workUnitId}/${caseId}/${assigned}/${finishDate}`,\n\n(sandbox.js line 31:37)\n\n  29 |     const token = req.data.token;\n  30 |     req.data.user = jwt.decode(token);\n> 31 |     req.data.userActivities = await fetchUserActivities(token, req.data.params);\n     |                                     ^\n  32 | }\n\n(sandbox.js line 44:18)","entity":{"shortid":"LWX1OfaBwy","name":"AveragePunctuation-script","content":"const axios = require('axios');\nconst jwt = require('jsonwebtoken');\n\nfunction getOptions(token) {\n    let bearerAccess = 'Bearer ' + token;\n\n    let options = {\n        headers: {\n            'Authorization': bearerAccess,\n        }\n    }\n    return options;\n}\n\nasync function fetchUserActivities(token, params) {\n    return new Promise((resolve, reject) => {\n        const {groupId, workUnitId, caseId, assigned, finishDate} = req.params;\n\n        axios.get(`http://localhost:12080/api/exercises/studentsAssignedToExerciseWithDetails/${groupId}/${workUnitId}/${caseId}/${assigned}/${finishDate}`,\n            getOptions(token)).then(response => {\n            resolve(response.data)\n        }).catch(err => {\n            reject(err.message);\n        })\n    })\n}\n\nasync function beforeRender(req, res) {\n    const token = req.data.token;\n    req.data.user = jwt.decode(token);\n    req.data.userActivities = await fetchUserActivities(token, req.data.params);\n}"},"property":"content","logged":true,"previousOperationId":"gfnkzihmdaffgmx","id":"42uwitschduoxak","stack":"ReferenceError: req is not defined\n    at sandbox.js:17:69\n    at new Promise (<anonymous>)\n    at fetchUserActivities (sandbox.js:16:12)\n    at Object.beforeRender (sandbox.js:31:37)\n    at executionFn (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:67:35)\n    at sandbox.js:44:18\n    at async run (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:137:16)\n    at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:14)\n    at async executeScript (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-scripts\\lib\\executeScript.js:122:12)\n    at async Scripts._runScript (C:\\Users\\Javier\\Desktop\\Proyecto\\proyectoNeonatos\\reports\\node_modules\\@jsreport\\jsreport-scripts\\lib\\worker.js:140:30)","message":"Error when evaluating custom script /templates/AveragePunctuations/AveragePunctuation-script\nreq is not defined\n\n(sandbox.js line 17:69)\n\n  15 | async function fetchUserActivities(token, params) {\n  16 |     return new Promise((resolve, reject) => {\n> 17 |         const {groupId, workUnitId, caseId, assigned, finishDate} = req.params;\n     |                                                                     ^\n  18 |\n  19 |         axios.get(`http://localhost:12080/api/exercises/studentsAssignedToExerciseWithDetails/${groupId}/${workUnitId}/${caseId}/${assigned}/${finishDate}`,\n  20 |             getOptions(token)).then(response => {\n\n(sandbox.js line 16:12)\n\n  14 |\n  15 | async function fetchUserActivities(token, params) {\n> 16 |     return new Promise((resolve, reject) => {\n     |            ^\n  17 |         const {groupId, workUnitId, caseId, assigned, finishDate} = req.params;\n  18 |\n  19 |         axios.get(`http://localhost:12080/api/exercises/studentsAssignedToExerciseWithDetails/${groupId}/${workUnitId}/${caseId}/${assigned}/${finishDate}`,\n\n(sandbox.js line 31:37)\n\n  29 |     const token = req.data.token;\n  30 |     req.data.user = jwt.decode(token);\n> 31 |     req.data.userActivities = await fetchUserActivities(token, req.data.params);\n     |                                     ^\n  32 | }\n\n(sandbox.js line 44:18)"}
